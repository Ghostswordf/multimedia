<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.2/shaka-player.ui.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.2/controls.min.css">
</head>
<body>
  <h2>AVC Adaptive Streaming</h2>
  <div data-shaka-player-container style="max-width:40em">
    <video data-shaka-player autoplay id="video" style="width:100%"></video>
  </div>
  <script>
    const manifestUri = 'https://raw.githubusercontent.com/Ghostswordf/multimedia/main/manifestlab4.mpd';
    console.log('Manifest URI:', manifestUri);  // ‚Üê Check this logs correctly

    // 1. Install polyfills and check browser support FIRST
    shaka.polyfill.installAll();
  
    if (shaka.Player.isBrowserSupported()) {
      console.log('Browser supported');
    } else {
      console.error('Browser not supported!');
      return;
    }
    
    // 2. Wait for DOM ready, THEN initialize
    async function initApp() {
      console.log('Initializing app...');
    
      // Find video element
      const video = document.getElementById('video');
      console.log('Video element found:', video);
      
      // 3. Create player manually (reliable method)
      const player = new shaka.Player(video);
      video.poster = ''; // Clear poster
    
      // 4. Get UI controls
      const container = video.parentElement;
      const ui = new shaka.ui.Overlay(player, container, video);
    
      // 5. Load manifest
      try {
        console.log('Loading manifest:', manifestUri);
        await player.load(manifestUri);
        console.log('Loaded successfully!');
      } catch (e) {
        console.error('Load failed:', e);
      }
    }
  
    // 6. Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
</body>
</html>
